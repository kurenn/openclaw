services:
  - type: web
    name: openclaw
    runtime: docker

    # If you hit OOM on "starter", bump to standard (2GB).
    # There's an open issue noting starter can be too small for gateway init.
    plan: standard

    healthCheckPath: /health

    envVars:
      # Render expects your app to bind to this port.
      - key: PORT
        value: "8080"

      # Prompts you during deploy (secret)
      - key: SETUP_PASSWORD
        sync: false

      # Persist config/workspace on the attached disk
      - key: OPENCLAW_STATE_DIR
        value: /data/.openclaw
      - key: OPENCLAW_WORKSPACE_DIR
        value: /data/workspace

      # Used to secure the gateway
      - key: OPENCLAW_GATEWAY_TOKEN
        generateValue: true

    disk:
      name: openclaw-data
      mountPath: /data
      sizeGB: 1

    # Force the gateway to bind to 0.0.0.0:$PORT (LAN) so Render can detect it.
    dockerCommand:
      - bash
      - -lc
      - |
        exec node dist/index.js gateway \
          --allow-unconfigured \
          --bind lan \
          --port "${PORT:-8080}" \
          --auth token \
          --token "${OPENCLAW_GATEWAY_TOKEN}"